<!DOCTYPE html>
<html lang="es" dir="ltr">
<head>
  <meta charset="UTF-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <title>Generador de Prompt Maestro ‚Äî IngLucas</title>
  <meta name="description" content="Herramienta para generar un Prompt Maestro que integra contenido en una plantilla base sin romper la estructura del sitio."/>
  <style>
    /* =========================================================
       Estilos base ‚Äî Todo encapsulado en [data-scope="ilh"]
       Objetivo: evitar solapamientos y mantener espaciados consistentes
       ========================================================= */
    :root{
      --bg:#0b1220;
      --card:#111a2b;
      --ink:#e8f0ff;
      --muted:#9bb0d1;
      --accent:#4cc9f0;
      --ok:#2bd164;
      --bad:#ff5964;
      --border:#23314e;

      --space-1:8px;
      --space-2:12px;
      --space-3:16px;
      --space-4:20px;
      --space-5:24px;
      --radius:16px;
      --radius-sm:10px;
      --field-bg:#0e1728;
    }

    [data-scope="ilh"]{
      box-sizing:border-box;
      font-family:system-ui,-apple-system,Segoe UI,Roboto,Ubuntu,Arial,sans-serif;
      color:var(--ink);
      background:var(--bg);
      min-height:100dvh;
      padding:var(--space-5);
    }
    [data-scope="ilh"] *, [data-scope="ilh"] *::before, [data-scope="ilh"] *::after{
      box-sizing:inherit;
    }

    .ilh-wrap{max-width:min(1200px, 100%); margin-inline:auto}
    h1{margin:0 0 var(--space-1)}
    .ilh-sub{color:var(--muted); margin:0 0 var(--space-4)}

    /* Tarjetas limpias (evitamos anidado excesivo) */
    .ilh-card{
      background:var(--card);
      border:1px solid var(--border);
      border-radius:var(--radius);
      padding:var(--space-4);
    }

    /* Grids fluidos sin solapamientos */
    .ilh-grid{
      display:grid;
      gap:var(--space-4);
    }
    /* 2 columnas solo si hay ancho suficiente */
    @media (min-width: 960px){
      .ilh-grid.cols-2{
        grid-template-columns:1fr 1fr;
      }
    }

    /* Controles */
    label{font-weight:600; display:block; margin:.35rem 0 .25rem}
    input[type="text"], input[type="search"], select, textarea{
      width:100%;
      padding:12px 14px;
      background:var(--field-bg);
      color:var(--ink);
      border:1px solid var(--border);
      border-radius:var(--radius-sm);
      line-height:1.4;
      font-family:ui-monospace, Menlo, Consolas, monospace;
    }
    textarea{min-height:180px; resize:vertical}
    .ilh-row{display:flex; gap:var(--space-3); flex-wrap:wrap}
    .ilh-row > *{flex:1 1 220px}

    .ilh-checks{display:grid; gap:var(--space-2)}
    .ilh-checks label{display:flex; gap:10px; align-items:flex-start; font-weight:500}

    .ilh-actions{display:flex; gap:var(--space-3); flex-wrap:wrap; align-items:center}
    button{
      background:var(--accent);
      color:#071120;
      border:0;
      border-radius:var(--radius-sm);
      padding:12px 16px;
      font-weight:700;
      cursor:pointer;
      min-height:44px;
    }
    button.secondary{background:#16233a; color:var(--ink); border:1px solid var(--border)}
    button.ok{background:var(--ok); color:#06210f}
    button:focus-visible{outline:2px solid #8fd3ff; outline-offset:2px}

    .ilh-hint{font-size:.92rem; color:var(--muted)}
    .ilh-preview{
      background:#0a1426;
      border:1px dashed var(--border);
      border-radius:var(--radius);
      padding:var(--space-3);
      white-space:pre-wrap;
      overflow:auto;
      max-height:55vh;
    }
    .ilh-chip{background:#12203a; color:var(--muted); padding:4px 8px; border-radius:8px; font-size:.82rem}
    .ilh-ok{color:var(--ok); font-weight:700}

    /* Listas y utilidades */
    ul{margin:0; padding-left:1.1rem}
    .mt-2{margin-top:var(--space-2)}
    .mt-3{margin-top:var(--space-3)}
    .mt-4{margin-top:var(--space-4)}
    .mb-0{margin-bottom:0}
  </style>
</head>
<body>
<main class="ilh-wrap" data-scope="ilh" id="app">
  <header class="mb-0">
    <h1>üß© Generador de Prompt Maestro</h1>
    <p class="ilh-sub">Integra contenido en tu plantilla sin romper header/drawer/utterances/footer/cookies. Marca opciones, genera y copia.</p>
  </header>

  <!-- 1) Entradas base -->
  <section class="ilh-card">
    <h2 class="mb-0">1) Entradas base</h2>
    <p class="ilh-hint mt-2">ES: Pega tu plantilla y el contenido del proyecto. | EN: Paste your base template and project content.</p>
    <div class="ilh-grid cols-2 mt-3">
      <div>
        <label for="template-input">Plantilla HTML base</label>
        <textarea id="template-input" placeholder="Pega aqu√≠ tu plantilla HTML completa..."></textarea>
      </div>
      <div>
        <label for="content-input">Contenido del proyecto (HTML o texto)</label>
        <textarea id="content-input" placeholder="Pega aqu√≠ tu contenido HTML o texto..."></textarea>
        <div class="ilh-row mt-2">
          <div>
            <label for="content-type">Tipo de contenido</label>
            <select id="content-type">
              <option value="html" selected>HTML</option>
              <option value="text">Texto (convertir a HTML limpio)</option>
            </select>
          </div>
          <div>
            <label for="structure">¬øEstructura acad√©mica?</label>
            <select id="structure">
              <option value="yes" selected>S√≠</option>
              <option value="no">No</option>
            </select>
          </div>
          <div>
            <label for="insertion-selector">Selector de inserci√≥n</label>
            <input id="insertion-selector" type="text" placeholder='Ej.: section.pane' value="section.pane"/>
            <p class="ilh-hint mt-2">ES: Selector CSS exacto donde se permite modificar. | EN: Exact allowed CSS edit scope.</p>
          </div>
        </div>
      </div>
    </div>
  </section>

  <!-- 2) Contexto del encargo -->
  <section class="ilh-card">
    <h2 class="mb-0">2) Contexto del encargo</h2>
    <div class="ilh-grid cols-2 mt-3">
      <div>
        <label for="goal">Objetivo del prompt</label>
        <input id="goal" type="text" placeholder="Ej.: Integrar un proyecto HTML en la plantilla sin romper el layout">
        <label for="audience" class="mt-2">Audiencia</label>
        <input id="audience" type="text" placeholder="Ej.: Usuarios no t√©cnicos, equipo acad√©mico, etc.">
        <div class="ilh-row mt-2">
          <div>
            <label for="tone">Tono/estilo</label>
            <select id="tone">
              <option>Formal docente</option>
              <option selected>Directo y t√©cnico</option>
              <option>Marketing persuasivo</option>
              <option>Neutro</option>
            </select>
          </div>
          <div>
            <label for="format">Formato de salida</label>
            <select id="format">
              <option selected>HTML completo</option>
              <option>Markdown</option>
              <option>Texto plano</option>
              <option>Lista numerada</option>
              <option>Tabla</option>
            </select>
          </div>
          <div>
            <label for="length">Longitud esperada</label>
            <select id="length">
              <option>Breve</option>
              <option selected>Media</option>
              <option>Larga</option>
              <option>L√≠mite 800 palabras</option>
            </select>
          </div>
        </div>
      </div>
      <div>
        <label for="positive-example">Mini ejemplo de lo deseado (opcional)</label>
        <textarea id="positive-example" placeholder="Ej.: Integrar secci√≥n con H2, respetar clases y comentar ES/EN..."></textarea>
        <label for="negative-example" class="mt-2">Qu√© NO hacer (opcional)</label>
        <textarea id="negative-example" placeholder="Ej.: No eliminar el banner de cookies ni mover el bot√≥n de comentarios..."></textarea>
      </div>
    </div>
  </section>

  <!-- 3) Reglas duras -->
  <section class="ilh-card">
    <h2 class="mb-0">3) Reglas duras (marca con palomita)</h2>
    <div class="ilh-grid cols-2 mt-3">
      <div class="ilh-checks">
        <label><input type="checkbox" class="hr" value="No modificar ni eliminar header, men√∫ lateral (drawer), bot√≥n de comentarios (utterances), footer ni banner de cookies." checked> No tocar header/drawer/utterances/footer/cookies.</label>
        <label><input type="checkbox" class="hr" value="Mantener la uniformidad del sitio (clases y animaciones existentes)."> Mantener clases/animaciones existentes.</label>
        <label><input type="checkbox" class="hr" value="Encapsular nuevos estilos con prefijo .ilh- o dentro de [data-scope=&quot;ilh&quot;]." checked> Encapsular estilos con <code>.ilh-</code> o <code>[data-scope=&quot;ilh&quot;]</code>.</label>
        <label><input type="checkbox" class="hr" value="Garantizar HTML v√°lido (W3C) y accesible; usar IDs √∫nicos y alt en im√°genes." checked> HTML v√°lido + accesibilidad + IDs √∫nicos.</label>
        <label><input type="checkbox" class="hr" value="Compatibilidad responsive en PC y m√≥viles sin librer√≠as externas nuevas."> Responsive sin librer√≠as nuevas.</label>
      </div>
      <div class="ilh-checks">
        <label><input type="checkbox" class="hr" value="Evitar sobrescribir variables globales o estilos base del sitio." checked> No sobrescribir variables/globales.</label>
        <label><input type="checkbox" class="hr" value="Comentarios biling√ºes ES/EN en el c√≥digo entregado."> Comentarios biling√ºes ES/EN.</label>
        <label><input type="checkbox" class="hr" value="Sanitizar/escapar scripts dentro del contenido si viene como texto." checked> Sanitizar scripts en contenido de texto.</label>
        <label><input type="checkbox" class="hr" value="No insertar iframes externos sin aviso; marcar como &quot;requiere revisi√≥n&quot;."> Iframes externos: marcar ‚Äúrequiere revisi√≥n‚Äù.</label>
        <label><input type="checkbox" class="hr" value="Evitar estilos inline salvo justificaci√≥n expl√≠cita."> Evitar estilos inline.</label>
      </div>
    </div>
    <p class="ilh-hint mt-2">ES: Estas reglas se pegan tal cual en el prompt. | EN: These rules are copied verbatim into the prompt.</p>
  </section>

  <!-- 4) Integraciones de la plantilla base (NUEVO) -->
  <section class="ilh-card">
    <h2 class="mb-0">4) Integraciones de la plantilla base (animaciones)</h2>
    <p class="ilh-hint mt-2">ES: Indica si se debe garantizar la integraci√≥n de los botones y sus animaciones originales. | EN: Indicate whether to guarantee original buttons + animations integration.</p>
    <div class="ilh-checks mt-2">
      <label><input type="checkbox" id="integrate-menu"> Integrar <strong>bot√≥n de men√∫ (drawer)</strong> con su animaci√≥n de la plantilla base.</label>
      <label><input type="checkbox" id="integrate-comments"> Integrar <strong>bot√≥n de comentarios (utterances)</strong> con sus animaciones de la plantilla base.</label>
    </div>
  </section>

  <!-- 5) Presets y acciones -->
  <section class="ilh-card">
    <h2 class="mb-0">5) Presets y acciones</h2>
    <div class="ilh-row mt-2">
      <div class="ilh-row" style="flex:2">
        <div>
          <label for="preset">Preset</label>
          <select id="preset">
            <option value="custom" selected>‚Äî Personalizado ‚Äî</option>
            <option value="html_puro">Insertar HTML puro</option>
            <option value="informe_academico">Informe acad√©mico</option>
            <option value="pagina_marketing">P√°gina de marketing r√°pida</option>
          </select>
        </div>
        <div>
          <label for="preset-name">Nombre para guardar el preset</label>
          <input id="preset-name" type="text" placeholder="Ej.: Trabajo SO v1"/>
        </div>
      </div>
      <div class="ilh-actions">
        <button id="apply-preset" class="secondary">Aplicar preset</button>
        <button id="save-preset" class="secondary">Guardar preset</button>
        <button id="generate-btn">üî® Generar prompt</button>
        <button id="copy-prompt-btn" class="ok" style="display:none;">üìã Copiar prompt</button>
        <span id="copy-status" class="ilh-ok" style="display:none;">‚úÖ Copiado</span>
      </div>
    </div>
    <p class="ilh-hint mt-2">ES: Los presets se guardan en el <em>localStorage</em> del navegador. | EN: Presets persist in browser localStorage.</p>
  </section>

  <!-- 6) Vista previa -->
  <section class="ilh-card">
    <h2 class="mb-0">6) Vista previa del prompt</h2>
    <div id="prompt-preview" class="ilh-preview mt-2">Genera el prompt para verlo aqu√≠‚Ä¶</div>
  </section>

  <!-- 7) Checklist autom√°tico -->
  <section class="ilh-card">
    <h2 class="mb-0">7) Checklist autom√°tico</h2>
    <ul id="auto-checklist" class="mt-2">
      <li>1) Plantilla presente: <span id="chk-template" class="ilh-chip">pendiente</span></li>
      <li>2) Contenido presente: <span id="chk-content" class="ilh-chip">pendiente</span></li>
      <li>3) Selector de inserci√≥n: <span id="chk-selector" class="ilh-chip">pendiente</span></li>
      <li>4) Reglas duras marcadas: <span id="chk-rules" class="ilh-chip">pendiente</span></li>
      <li>5) Contexto del encargo: <span id="chk-context" class="ilh-chip">pendiente</span></li>
    </ul>
  </section>
</main>

<script>
  // ===============================
  // Utilidades b√°sicas
  // ===============================
  const $  = s => document.querySelector(s);
  const $$ = s => Array.from(document.querySelectorAll(s));

  function convertTextToHTML(text){
    // ES: Convierte texto simple en p√°rrafos HTML seguros
    // EN: Convert plain text to safe HTML paragraphs
    const safe = text.replace(/</g,'&lt;').replace(/>/g,'&gt;').trim();
    if(!safe) return '<section data-scope="ilh"></section>';
    const chunks = safe.split(/\\n{2,}/).map(p => `<p>${p.replace(/\\n/g,'<br/>')}</p>`);
    return `<section data-scope="ilh">\\n${chunks.join('\\n')}\\n</section>`;
  }

  function wrapAcademicStructure(contentHTML){
    return `
<section class="pane" data-scope="ilh">
  <article>
    <h2>Introducci√≥n</h2>
    <p><!-- ES: Agrega una introducci√≥n; EN: Add an introduction --></p>

    <h2>Desarrollo</h2>
    ${contentHTML}

    <h2>Conclusiones</h2>
    <p><!-- ES: Sintetiza puntos clave; EN: Summarize key points --></p>

    <h2>Referencias</h2>
    <p><!-- ES: A√±ade referencias (APA breve); EN: Add brief APA references --></p>
  </article>
</section>`.trim();
  }

  function getCheckedRules(){
    return $$('.hr').filter(i=>i.checked).map(i=>i.value);
  }
  function summarizeRules(rules){
    return rules.length ? '‚Ä¢ ' + rules.join('\\n‚Ä¢ ') : '‚Äî';
  }
  function short(v, fb='‚Äî'){ return (v||'').trim() ? v.trim() : fb; }

  // ===============================
  // Checklist en vivo
  // ===============================
  function updateChecklist(){
    $('#chk-template').textContent = $('#template-input').value.trim() ? 'ok' : 'pendiente';
    $('#chk-content').textContent  = $('#content-input').value.trim() ? 'ok' : 'pendiente';
    $('#chk-selector').textContent = $('#insertion-selector').value.trim() ? 'ok' : 'pendiente';
    $('#chk-rules').textContent    = getCheckedRules().length >= 3 ? 'ok' : 'pendiente';
    const ctxOK = $('#goal').value.trim() || $('#audience').value.trim();
    $('#chk-context').textContent  = ctxOK ? 'ok' : 'pendiente';
  }
  ['template-input','content-input','insertion-selector','goal','audience'].forEach(id=>{
    document.getElementById(id).addEventListener('input', updateChecklist);
  });
  $$('.hr').forEach(c=>c.addEventListener('change', updateChecklist));
  $$('#integrate-menu, #integrate-comments').forEach(c=>c.addEventListener('change', ()=>{}));
  updateChecklist();

  // ===============================
  // Presets
  // ===============================
  const builtInPresets = {
    html_puro: {
      structure:'no', tone:'Directo y t√©cnico', format:'HTML completo', length:'Breve',
      rules:[
        'Mantener la uniformidad del sitio (clases y animaciones existentes).',
        'Encapsular nuevos estilos con prefijo .ilh- o dentro de [data-scope="ilh"].',
        'Garantizar HTML v√°lido (W3C) y accesible; usar IDs √∫nicos y alt en im√°genes.'
      ],
      integrates:{menu:true, comments:false}
    },
    informe_academico: {
      structure:'yes', tone:'Formal docente', format:'HTML completo', length:'Larga',
      rules:[
        'No modificar ni eliminar header, men√∫ lateral (drawer), bot√≥n de comentarios (utterances), footer ni banner de cookies.',
        'Comentarios biling√ºes ES/EN en el c√≥digo entregado.',
        'Evitar sobrescribir variables globales o estilos base del sitio.'
      ],
      integrates:{menu:true, comments:true}
    },
    pagina_marketing: {
      structure:'no', tone:'Marketing persuasivo', format:'HTML completo', length:'Media',
      rules:[
        'Mantener la uniformidad del sitio (clases y animaciones existentes).',
        'No insertar iframes externos sin aviso; marcar como "requiere revisi√≥n".',
        'Evitar estilos inline salvo justificaci√≥n expl√≠cita.'
      ],
      integrates:{menu:true, comments:false}
    }
  };

  function applyPresetData(p){
    if(!p) return;
    $('#structure').value = p.structure || 'no';
    $('#tone').value      = p.tone || 'Neutro';
    $('#format').value    = p.format || 'HTML completo';
    $('#length').value    = p.length || 'Media';
    // Reglas
    $$('.hr').forEach(c=>c.checked=false);
    (p.rules||[]).forEach(v=>{
      const box = $$('.hr').find(c=>c.value===v);
      if(box) box.checked = true;
    });
    // Integraciones
    $('#integrate-menu').checked     = !!(p.integrates && p.integrates.menu);
    $('#integrate-comments').checked = !!(p.integrates && p.integrates.comments);
    updateChecklist();
  }

  function saveCustomPreset(name){
    if(!name.trim()){ alert('Pon un nombre para el preset.'); return; }
    const data = {
      structure: $('#structure').value,
      tone: $('#tone').value,
      format: $('#format').value,
      length: $('#length').value,
      rules: getCheckedRules(),
      integrates: {
        menu: $('#integrate-menu').checked,
        comments: $('#integrate-comments').checked
      }
    };
    localStorage.setItem('ilh-preset-'+name, JSON.stringify(data));
    alert('Preset guardado: ' + name);
  }
  function loadCustomPreset(name){
    const raw = localStorage.getItem('ilh-preset-'+name);
    if(!raw){ alert('No existe un preset con ese nombre.'); return; }
    applyPresetData(JSON.parse(raw));
  }

  $('#apply-preset').addEventListener('click', ()=>{
    const val = $('#preset').value;
    if(val==='custom'){
      const name = prompt('Nombre del preset a cargar (guardado por ti):');
      if(name){ loadCustomPreset(name); }
    }else{
      applyPresetData(builtInPresets[val]);
    }
  });
  $('#save-preset').addEventListener('click', ()=>{
    const name = $('#preset-name').value || prompt('Nombre para el preset:');
    if(name){ saveCustomPreset(name); }
  });

  // ===============================
  // Generaci√≥n del prompt
  // ===============================
  let lastPrompt = '';

  function buildPrompt(){
    const template = $('#template-input').value;
    const contentRaw = $('#content-input').value;
    const contentType = $('#content-type').value;
    const structure = $('#structure').value;
    const insertionSelector = $('#insertion-selector').value;

    const goal = $('#goal').value;
    const audience = $('#audience').value;
    const tone = $('#tone').value;
    const format = $('#format').value;
    const length = $('#length').value;
    const posEx = $('#positive-example').value;
    const negEx = $('#negative-example').value;

    const integrateMenu = $('#integrate-menu').checked;
    const integrateComments = $('#integrate-comments').checked;

    // Validaciones b√°sicas
    if(!template.trim()){ alert('Falta la plantilla base.'); return ''; }
    if(!contentRaw.trim()){ alert('Falta el contenido del proyecto.'); return ''; }
    if(!insertionSelector.trim()){ alert('Falta el selector de inserci√≥n.'); return ''; }

    // Integraci√≥n de contenido
    let integratedContent = (contentType === 'text') ? convertTextToHTML(contentRaw) : contentRaw;
    if(structure === 'yes'){
      integratedContent = wrapAcademicStructure(integratedContent);
    }

    const hardRules = getCheckedRules();
    // Agrega reglas espec√≠ficas si marcaste integraciones
    if(integrateMenu){
      hardRules.push('Mantener y/o reconectar el bot√≥n de men√∫ (drawer) con su animaci√≥n original de la plantilla base.');
    }
    if(integrateComments){
      hardRules.push('Mantener y/o reconectar el bot√≥n de comentarios (utterances) con sus animaciones originales de la plantilla base.');
    }
    // Quitar duplicados
    const hardRulesUnique = [...new Set(hardRules)];
    const hardRulesSummary = hardRulesUnique.length ? '‚Ä¢ ' + hardRulesUnique.join('\\n‚Ä¢ ') : '‚Äî';

    const opcionesSel = [
      `Estructura acad√©mica: ${structure === 'yes' ? 'S√≠ / Yes' : 'No'}`,
      `Tipo de contenido: ${contentType === 'text' ? 'Texto (convertir a HTML)' : 'HTML directo'}`,
      `Integraci√≥n bot√≥n de men√∫ (drawer + animaci√≥n): ${integrateMenu ? 'S√≠ / Yes' : 'No'}`,
      `Integraci√≥n bot√≥n de comentarios (utterances + animaciones): ${integrateComments ? 'S√≠ / Yes' : 'No'}`
    ].join('\\n- ');

    const prompt =
`üìù Prompt Maestro para integraci√≥n de contenido en plantilla base
________________________________________
Prop√≥sito / Purpose:
- ES: ${short(goal,'Integrar contenido en plantilla base sin romper la estructura.')}
- EN: ${short(goal,'Integrate project content into the base template without breaking the layout.')}

Audiencia / Audience: ${short(audience,'Mixta / General')}
Tono / Tone: ${tone}
Formato de salida / Output format: ${format}
Longitud / Length: ${length}
Selector de inserci√≥n permitido / Allowed insertion selector: "${insertionSelector}"

‚öôÔ∏è Condiciones obligatorias (no negociables) / Hard rules:
${hardRulesSummary}

Notas de calidad / Quality constraints:
- ES: Mantener accesibilidad (IDs √∫nicos, alt en im√°genes); conservar clases/animaciones existentes; no sobrescribir variables globales; evitar estilos inline salvo justificaci√≥n; sanitizar scripts si el contenido viene como texto; iframes externos: marcar "requiere revisi√≥n".
- EN: Keep accessibility (unique IDs, alt on images); preserve existing classes/animations; do not override global variables; avoid inline styles unless justified; sanitize scripts if content comes as text; external iframes: mark as "requires review".

Zonas de edici√≥n / Edit scopes:
- ES: Solo modificar el contenido dentro del selector indicado. Ning√∫n otro bloque debe ser alterado.
- EN: Only modify content within the specified selector. No other block must be changed.

üîß Opciones seleccionadas / Selected options:
- ${opcionesSel}

‚úÖ Checklist que debes confirmar antes de devolver / Must confirm before delivering:
1) Header, drawer, utterances, footer y cookies intactos.
2) Inserci√≥n realizada √öNICAMENTE en "${insertionSelector}".
3) HTML v√°lido y accesible; sin IDs duplicados.
4) Estilos nuevos encapsulados (.ilh- o [data-scope="ilh"]).
5) Responsive funcional en PC y m√≥viles.
6) Comentarios ES/EN a√±adidos.
${integrateMenu ? '7) El bot√≥n de men√∫ (drawer) mantiene su animaci√≥n y funcionalidad originales.' : ''}
${integrateComments ? '8) El bot√≥n de comentarios (utterances) mantiene sus animaciones y funcionalidad originales.' : ''}

Ejemplo positivo (opcional) / Positive example (optional):
${short(posEx, '‚Äî')}

Qu√© NO hacer (opcional) / What NOT to do (optional):
${short(negEx, '‚Äî')}

üìÑ Contenido a integrar / Content to integrate:
${integratedContent}

üìÅ Plantilla HTML base / Base template:
${template}
`;
    return prompt;
  }

  // Eventos
  $('#generate-btn').addEventListener('click', ()=>{
    const p = buildPrompt();
    if(!p) return;
    lastPrompt = p;
    $('#prompt-preview').textContent = p;
    $('#copy-prompt-btn').style.display = 'inline-block';
    updateChecklist();
  });
  $('#copy-prompt-btn').addEventListener('click', ()=>{
    if(!lastPrompt){ alert('Primero, genera el prompt.'); return; }
    navigator.clipboard.writeText(lastPrompt).then(()=>{
      const el = $('#copy-status');
      el.style.display = 'inline-block';
      setTimeout(()=> el.style.display='none', 1600);
    });
  });

  // Presets (accesos r√°pidos ya declarados arriba)
  $('#apply-preset').addEventListener('click', ()=>{
    const val = $('#preset').value;
    if(val==='custom'){
      const name = prompt('Nombre del preset a cargar (guardado por ti):');
      if(name){ loadCustomPreset(name); }
    }else{
      applyPresetData(builtInPresets[val]);
    }
  });
  $('#save-preset').addEventListener('click', ()=>{
    const name = $('#preset-name').value || prompt('Nombre para el preset:');
    if(name){ saveCustomPreset(name); }
  });
</script>
</body>
</html>
